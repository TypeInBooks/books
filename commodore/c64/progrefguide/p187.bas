10 s=54272:for l=s to s+24:pokel,0:next
20 dim h(2,200),l(2,200),c(2,200)
30 dim fq(11)
40 v(0)=17:v(1)=65:v(2)=33
50 poke s+10,8:poke s+22,128:poke s+23,244
60 for i=0 to 11:read fq(i):next
100 for k=0 to 2
110 i=0
120 read nm
130 if nm=0 then 250
140 wa=v(k):wb=wa-1:if nm<0 then nm=-nm:wa=0:wb=0
150 dr%=nm/128:oc%=(nm-128*dr%)/16
160 nt=nm-128*dr%-16*oc%
170 fr=fq(nt)
180 if oc%=7 then 200
190 for j=6 to oc% step-1:fr=fr/2:next
200 hf%=fr/256:lf%=fr-256*hf%
210 if dr%=1 then h(k,i)=hf%:l(k,i)=lf%:c(k,i)=wa:i=i+1:goto 120
220 for j=1 to dr%-1:h(k,i)=hf%:l(k,i)=lf%:c(k,i)=wa:i=i+1:next
230 h(k,i)=hf%:l(k,i)=lf%:c(k,i)=wb
240 i=i+1:goto 120
250 if i>im then im=i
260 next
500 poke s+5,0:poke s+6,240
510 poke s+12,85:poke s+13,133
520 poke s+19,10:poke s+20,197
530 poke s+24,31
540 for i=0 to im
550 poke s,l(0,i):poke s+7,l(1,i):poke s+14,l(2,i)
560 poke s+1,h(0,i):poke s+8,h(1,i):poke s+15,h(2,i)
570 poke s+4,c(0,i):poke s+11,c(1,i):poke s+18,c(2,i)
580 for t=1 to 80:next:next
590 for t=1 to 200:next:poke s+24,0
600 data 34334,36376,38539,40830
610 data 43258,45830,48556,51443
620 data 54502,57743,61176,64814
1000 data 594,594,594,596,596
1010 data 1618,587,592,587.585,331,336
1020 data 1097,583,585,585,585,587,587
1030 data 1609,585,331,337,594,594,593
1040 data 1618,594,596,594,592,587
1050 data 1616,587,585,331,336,841,327
1060 data 1607
1999 data 0
2000 data 583,585,583,583,327,329
2010 data 1611,583,585,578,578,578
2020 data 196,198,583,326,578
2030 data 326,327,329,327,329,326,578,583
2040 data 1606,582,322,324,582,587
2050 data 329,327,1606,583
2060 data 327,329,587,331,329
2070 data 329,328,1609,578,834
2080 data 324,322,327,585,1602
2999 data 0
3000 data 567,566,567,304,306,308,310
3010 data 1591,567,311,310,567
3020 data 306,304,299,308
3030 data 304,171,176,306,291,551,306,308
3040 data 310,308,310,306,295,297,299,304
3050 data 1586,562,567,310,315,311
3060 data 308,313,297
3070 data 1586,567,560,311,309
3080 data 308,309,306,308
3090 data 1577,299,295,306,310,311,304
3100 data 562,546,1575
3999 data 0
